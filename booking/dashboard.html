<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Dashboard - Nomad Connect</title>
    <link rel="icon" type="image/png" href="../images/logo.png">
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css' rel='stylesheet' />
</head>
<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-content">
            <div class="logo-section">
                <img src="../images/logo.png" alt="Nomad Connect" class="logo-img">
                <div>
                    <h2>Nomad Connect</h2>
                    <span>Customer Dashboard</span>
                </div>
            </div>
            <div class="header-actions">
                <span id="user-name" class="user-name"></span>
                <button id="logout-btn" class="btn btn-secondary">Logout</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="dashboard-container">
        <div class="container">
            <!-- Welcome Section -->
            <div class="welcome-section">
                <h1>Welcome back, <span id="welcome-name"></span>!</h1>
                <p>Manage your Starlink bookings and create new reservations</p>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button id="new-booking-btn" class="btn btn-primary btn-lg">
                    üìÖ Create New Booking
                </button>
            </div>

            <!-- My Bookings Section -->
            <div class="bookings-section">
                <h2>My Bookings</h2>
                <div id="bookings-container" class="bookings-grid">
                    <!-- Bookings will be loaded here -->
                </div>
                <div id="loading-bookings" class="loading-spinner">
                    <div class="spinner"></div>
                    <p>Loading your bookings...</p>
                </div>
                <div id="no-bookings" class="empty-state" style="display: none;">
                    <div class="empty-icon">üì≠</div>
                    <h3>No bookings yet</h3>
                    <p>Start by creating your first Starlink rental booking!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- New Booking Modal -->
    <div id="booking-modal" class="modal">
        <div class="modal-content modal-large">
            <span class="close-modal">&times;</span>
            <h2>Create New Booking</h2>
            
            <form id="booking-form">
                <!-- Rental Information -->
                <div class="form-section">
                    <h3>Rental Information</h3>
                    <p style="background: rgba(79, 163, 154, 0.1); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                        <strong style="color: var(--dark-teal); font-size: 18px;">Daily Rate: ‚Ç±1,399</strong><br>
                        <span style="color: var(--text-light); font-size: 14px;">50% down payment required to confirm reservation</span>
                    </p>
                    
                    <!-- Calendar Legend -->
                    <div style="display: flex; gap: 16px; margin-bottom: 16px; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #4CAF50; border-radius: 4px;"></div>
                            <span style="font-size: 14px; color: var(--text-dark);">Available</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #F44336; border-radius: 4px;"></div>
                            <span style="font-size: 14px; color: var(--text-dark);">Booked</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #4FA39A; border-radius: 4px;"></div>
                            <span style="font-size: 14px; color: var(--text-dark);">Selected</span>
                        </div>
                    </div>
                    
                    <!-- Visual Calendar -->
                    <div id="booking-calendar" style="margin-bottom: 24px; background: white; padding: 16px; border-radius: 12px; border: 2px solid var(--sand);"></div>
                    
                    <!-- Date Inputs (Hidden but still functional) -->
                    <div class="date-inputs">
                        <div class="form-group">
                            <label for="start-date">Start Date</label>
                            <input type="text" id="start-date" placeholder="Click calendar to select" required readonly>
                        </div>
                        <div class="form-group">
                            <label for="end-date">End Date</label>
                            <input type="text" id="end-date" placeholder="Click calendar to select" required readonly>
                        </div>
                    </div>
                    <p class="date-note" id="calendar-note">Click on the calendar to select your rental dates</p>
                </div>

                <!-- Delivery Details -->
                <div class="form-section">
                    <h3>Delivery Details</h3>
                    <div class="form-group">
                        <label for="delivery-address">Delivery Address</label>
                        <textarea id="delivery-address" rows="3" required placeholder="Complete delivery address"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="special-requests">Special Requests (Optional)</label>
                        <textarea id="special-requests" rows="2" placeholder="Any special instructions or requirements"></textarea>
                    </div>
                </div>

                <!-- Payment -->
                <div class="form-section">
                    <h3>Down Payment (50%)</h3>
                    <p style="background: rgba(255, 152, 0, 0.1); padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--warning);">
                        <strong>‚ö†Ô∏è Important:</strong> Pay 50% down payment to confirm your reservation. 
                        Remaining balance, security deposit, and valid ID required upon pickup/delivery.
                    </p>
                    
                    <div class="payment-selector">
                        <label class="payment-option">
                            <input type="radio" name="payment" value="gcash" required>
                            <div class="payment-card">
                                <div class="payment-icon">üí≥</div>
                                <h4>GCash</h4>
                                <p>Pay via GCash</p>
                            </div>
                        </label>
                        <label class="payment-option">
                            <input type="radio" name="payment" value="direct" required>
                            <div class="payment-card">
                                <div class="payment-icon">üíµ</div>
                                <h4>Direct Payment</h4>
                                <p>Pay upon pickup/delivery</p>
                            </div>
                        </label>
                    </div>

                    <!-- GCash Payment Proof Upload -->
                    <div id="gcash-upload-section" class="upload-section" style="display: none;">
                        <div class="gcash-instructions">
                            <h4>GCash Payment Instructions:</h4>
                            <ol>
                                <li>Send <strong>50% down payment</strong> to: <strong>0912-XXX-XXXX</strong></li>
                                <li>Use reference: <strong>NC-[Your Name]</strong></li>
                                <li>Upload screenshot below</li>
                            </ol>
                        </div>
                        <div class="form-group">
                            <label for="payment-proof">Upload Payment Proof</label>
                            <input type="file" id="payment-proof" accept="image/*">
                            <p class="file-note">Upload screenshot of your GCash payment</p>
                        </div>
                        <div id="image-preview"></div>
                    </div>
                </div>

                <!-- Terms & Conditions -->
                <div class="form-section">
                    <h3>Terms & Conditions</h3>
                    <div style="background: var(--cream); padding: 20px; border-radius: 12px; max-height: 300px; overflow-y: auto; border: 2px solid var(--sand);">
                        <ul style="margin-left: 20px; line-height: 1.8;">
                            <li>A <strong>50% down payment</strong> is required to reserve the equipment/date.</li>
                            <li>Full payment, security deposit, and a <strong>valid government-issued ID</strong> are required upon pickup or before delivery of the equipment.</li>
                            <li><strong>Strictly no refunds</strong> once payment is made.</li>
                            <li>Reservations are confirmed only after the down payment is received.</li>
                            <li>Rental period starts upon release of the equipment and ends at the agreed return time.</li>
                            <li><strong>Late returns may incur additional charges.</strong></li>
                            <li>The renter is <strong>fully responsible for any loss or damage</strong> to the equipment.</li>
                        </ul>
                    </div>
                    
                    <div style="margin-top: 16px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="terms-checkbox" required style="width: 20px; height: 20px; cursor: pointer;">
                            <span style="font-weight: 600; color: var(--dark-teal);">I have read and agree to the Terms & Conditions</span>
                        </label>
                    </div>
                </div>

                <!-- Price Summary -->
                <div class="price-summary">
                    <h3>Booking Summary</h3>
                    <div class="summary-row">
                        <span>Daily Rate:</span>
                        <span>‚Ç±1,399</span>
                    </div>
                    <div class="summary-row">
                        <span>Duration:</span>
                        <span id="summary-duration">-</span>
                    </div>
                    <div class="summary-row">
                        <span>Dates:</span>
                        <span id="summary-dates">-</span>
                    </div>
                    <div class="summary-row total">
                        <span>Total Amount:</span>
                        <span id="summary-total">‚Ç±0</span>
                    </div>
                    <div class="summary-row" style="border-top: 2px solid var(--warning); background: rgba(255, 152, 0, 0.05); padding: 12px; border-radius: 8px; margin-top: 8px;">
                        <span style="font-weight: 600;">Down Payment (50%):</span>
                        <span id="summary-down-payment" style="font-weight: 700; color: var(--warning);">‚Ç±0</span>
                    </div>
                </div>

                <div id="form-error" class="error-message"></div>
                <button type="submit" class="btn btn-primary btn-full">Submit Booking</button>
            </form>

    <!-- Booking Detail Modal -->
    <div id="detail-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Booking Details</h2>
            <div id="booking-detail-content"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    <script src="dashboard.js"></script>
</body>
</html>